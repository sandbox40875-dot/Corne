# =====================================================
# ZMK – Corne (Wireless Split)
# Stable Bluetooth + Safe Macros + Reliable Wake
# =====================================================

# -----------------------------------------------------
# Bluetooth – STABLE (Fixes "connected but dead" issue)
# -----------------------------------------------------

CONFIG_BT=y
CONFIG_BT_PERIPHERAL=y
CONFIG_BT_CTLR_SCHED_ADVANCED=y

# Balanced connection interval (stable on laptops)
# 8 = 10 ms, 16 = 20 ms
CONFIG_BT_PERIPHERAL_PREF_MIN_INT=8
CONFIG_BT_PERIPHERAL_PREF_MAX_INT=16

# IMPORTANT: allow small slave latency (prevents BLE stall)
CONFIG_BT_PERIPHERAL_PREF_SLAVE_LATENCY=2

# Supervision timeout (units of 10 ms)
CONFIG_BT_PERIPHERAL_PREF_TIMEOUT=600

# RF reliability
CONFIG_BT_CTLR_TX_PWR_PLUS_8=y

# -----------------------------------------------------
# Sleep & Wake – RELIABLE
# -----------------------------------------------------

CONFIG_ZMK_SLEEP=y

# 1 hour idle sleep
CONFIG_ZMK_IDLE_SLEEP_TIMEOUT=3600000

# CRITICAL: wake immediately on key press
CONFIG_ZMK_KSCAN_WAKEUP_ENABLE=y

# -----------------------------------------------------
# Matrix Scan
# -----------------------------------------------------

CONFIG_ZMK_KSCAN_DEBOUNCE_PRESS_MS=5
CONFIG_ZMK_KSCAN_DEBOUNCE_RELEASE_MS=5

# -----------------------------------------------------
# Split Keyboard
# -----------------------------------------------------

CONFIG_ZMK_SPLIT=y
CONFIG_ZMK_SPLIT_BLE=y

CONFIG_ZMK_SPLIT_BLE_CENTRAL_POSITION_QUEUE_SIZE=16
CONFIG_ZMK_SPLIT_BLE_PERIPHERAL_POSITION_QUEUE_SIZE=16

# -----------------------------------------------------
# Remove unused hardware
# -----------------------------------------------------

CONFIG_ZMK_DISPLAY=n
CONFIG_ZMK_RGB_UNDERGLOW=n
CONFIG_ZMK_BACKLIGHT=n
CONFIG_I2C=n
CONFIG_SPI=n

# -----------------------------------------------------
# Bluetooth device name
# -----------------------------------------------------

CONFIG_BT_DEVICE_NAME="MK42Keyboard"

# -----------------------------------------------------
# DO NOT ENABLE (BREAKS BLE & WAKE)
# -----------------------------------------------------
# CONFIG_PM
# CONFIG_PM_DEVICE
# CONFIG_ZMK_PM